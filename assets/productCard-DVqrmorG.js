import{ad as I,q as W,h as N,m as y,o as x,s as t,v as s,E as B,D as m,y as l,S as k,C as q,_ as F,g as f,i as T,j as P,ah as R,aJ as U,a as A,B as S,Q as D,b as g,V as v,n as O,x as h,U as j,l as L}from"./index-CoNJkl2v.js";import{V as w}from"./VChip-D31goacF.js";const C={__name:"favoriteButton",props:{productId:{type:String,required:!0}},setup(o){const u=o,d=I(),i=W(),r=N(()=>d.favorites.some(n=>n._id===u.productId)),c=async()=>{d.isLoggedIn||i.push("/register"),await d.toggleFavorite(u.productId)};return(n,_)=>(x(),y(q,{class:"no-swipe-click",icon:"",onClick:k(c,["stop","prevent"])},{default:t(()=>[s(B,{color:r.value?"red":""},{default:t(()=>[m(l(r.value?"mdi-heart":"mdi-heart-outline"),1)]),_:1},8,["color"])]),_:1}))}},X={class:"text-medium-emphasis"},J={__name:"productCard",props:{_id:{type:String,required:!0},image:{type:String,required:!0},emotions:{type:String,required:!0},category:{type:String,required:!0},description:{type:String,required:!0},name:{type:String,required:!0},price:{type:[Number,String],required:!0}},setup(o){const u=o,d=N(()=>{const e=Number(u.price);if(isNaN(e))return u.price;if(e>=1e5){const a=Math.floor(e/1e4);return`$${Math.min(a,99)}萬+`}return`$${new Intl.NumberFormat("en-US").format(e)}`}),i=f(!1),r=f(null),c=f(null);let n=null;const _=()=>{const e=r.value,a=e==null?void 0:e.parentElement;if(e&&a&&e.scrollWidth>a.clientWidth){const p=e.scrollWidth-a.clientWidth;e.style.transform=`translateX(-${p}px)`}},z=()=>{r.value&&(r.value.style.transform="translateX(0)")},b=()=>{L(()=>{var V;const e=(V=c.value)==null?void 0:V.parentElement,a=c.value;if(!e||!a)return;a.style.fontSize="1rem";const p=Number.parseFloat(window.getComputedStyle(a).fontSize);if(a.scrollWidth>e.clientWidth){const $=e.clientWidth/a.scrollWidth,E=Math.max(8,p*$);a.style.fontSize=`${E}px`}})};T(()=>{var a;const e=(a=c.value)==null?void 0:a.parentElement;e&&(n=new ResizeObserver(b),n.observe(e)),b()}),P(()=>{n&&n.disconnect()});const M=()=>{i.value=!i.value};return(e,a)=>(x(),y(S,{key:o._id,class:"mx-auto position-relative text-text",to:`/product/${o._id}`,onMouseleave:z,onMouseover:_},{default:t(()=>[s(R,{"aspect-ratio":1/1,class:"align-end",cover:"",gradient:"to bottom, rgba(0,0,0,.1), rgba(0,0,0,.5)",src:o.image},{default:t(()=>[s(C,{class:"position-absolute top-0 right-0","product-id":o._id},null,8,["product-id"]),s(U,null,{default:t(()=>[i.value?(x(),y(S,{key:0,class:"mt-0 description-overlay position-absolute top-0 left-0 right-0 bottom-0 pa-2 overflow-y-auto rounded-0",elevation:"0",flat:""},{default:t(()=>[s(C,{class:"position-absolute top-0 right-0","product-id":o._id},null,8,["product-id"]),s(D,{class:"pb-0"},{default:t(()=>[s(v,{class:O(["align-center",{"flex-column":e.$vuetify.display.mdAndDown}]),"no-gutters":""},{default:t(()=>[s(h,{class:"d-flex flex-column flex-sm-row align-start align-lg-center mb-2",cols:"12"},{default:t(()=>[s(w,{class:"me-1 mb-1",size:"small"},{default:t(()=>[m(l(o.emotions),1)]),_:1}),s(w,{size:"small"},{default:t(()=>[m(l(o.category),1)]),_:1})]),_:1})]),_:1},8,["class"]),g("p",X,l(o.description),1)]),_:1})]),_:1})):A("",!0)]),_:1})]),_:1},8,["src"]),s(j,{class:"d-flex flex-column pa-2 position-relative"},{default:t(()=>[s(v,{class:"d-flex w-100 align-center mt-2 px-2","no-gutters":""},{default:t(()=>[s(h,{class:"text-left mb-0 py-0 name-container",cols:"8"},{default:t(()=>[g("span",{ref_key:"nameEl",ref:r,class:"name-text text-h6"},l(o.name),513)]),_:1}),s(h,{class:"text-right py-0 price-container",cols:"4"},{default:t(()=>[g("span",{ref_key:"priceEl",ref:c,class:"price-text"},l(d.value),513)]),_:1})]),_:1}),s(v,{class:"w-100 d-flex justify-center pb-4"},{default:t(()=>[s(q,{class:"no-swipe-click",color:"accent",variant:"outlined",onClick:k(M,["stop","prevent"])},{default:t(()=>[m(l(i.value?"關閉描述":"看商品描述"),1)]),_:1})]),_:1})]),_:1})]),_:1},8,["to"]))}},H=F(J,[["__scopeId","data-v-089be8be"]]);export{H as P,C as _};
